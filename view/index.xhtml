
<div id="list">
  <h2>アプリケーション一覧</h2>
  <?r if @applications.nil? or @applications.empty? ?>
      
  <?r else ?>
    <table>
      <tr>
        <th>名前</th>
        <th>バージョン</th>
        <th>状態</th>
        <th>操作</th>
      </tr>
      <?r @applications.each do |app| ?>
      <tr>
        <?r if app.pid ?>
          <td>
            <a href='http://localhost:#{h app.port}' target='_blank'>#{h app.name}</a>
          </td>
          <td>
            #{h app.version}
          </td>
          <td>
            ON / #{Applications.a("OFF", :stop, app.id)}
          </td>
        <?r else ?>
          <td>
            #{h app.name}
          </td>
          <td>
            #{h app.version}
          </td>
          <td>
            <a href='#{Applications.r(:start, app.id)}' target='_blank' onclick='setTimeout(function(){window.location = window.location;}, 1000)'>
              ON</a> / OFF
          </td>
        <?r end ?>
          <td>
            #{Applications.a("-", :uninstall, app.id)}
          </td>
      </tr>
      <?r end ?>
    </table>
  <?r end ?>
</div>
<div id="new">
  <h2>アプリケーションの追加</h2>

  <form action="#{Applications.r(:install)}" method="POST" enctype="multipart/form-data">
    <input type="file" name="gem">
    <input type="submit" value="送信">
  </form>
</div>

<div id="debug" style="display:block;">
</div>
