
<div id="list">
  <h2>Listing Applications</h2>
  <?r if @applications.nil? or @applications.empty? ?>
      
  <?r else ?>
    <table>
      <tr>
        <th>Name</th>
        <th>Version</th>
        <th>State</th>
        <th>Operation</th>
      </tr>
      <?r @applications.each do |app| ?>
      <tr>
        <?r if app.pid ?>
          <td>
            <a href='http://localhost:#{h app.port}' target='_blank'>#{h app.name}</a>
          </td>
          <td>
            #{h app.version}
          </td>
          <td>
            ON / #{Applications.a("OFF", :stop, app.id)}
          </td>
        <?r else ?>
          <td>
            #{h app.name}
          </td>
          <td>
            #{h app.version}
          </td>
          <td>
            <a href='#{Applications.r(:start, app.id)}' target='_blank' onclick='setTimeout(function(){window.location = window.location;}, 1000)'>
              ON</a> / OFF
          </td>
        <?r end ?>
          <td>
            #{Applications.a("-", :uninstall, app.id)}
          </td>
      </tr>
      <?r end ?>
    </table>
  <?r end ?>
</div>
<div id="new">
  <h2>Installing Applications</h2>
  <input type="radio" id="by_name_button" checked>
  <label for="by_name_button">by name</label>
  <input type="radio" id="by_file_button">
  <label for="by_file_button">by file</label>

  <div id="by_name">
    <form action="#{Applications.r(:install)}" method="POST" enctype="multipart/form-data">
      <input type="text" name="name" size="30">
      <input type="submit" value="install">
    </form>
  </div>

  <div id="by_file" style="display: none;">
    <form action="#{Applications.r(:install)}" method="POST" enctype="multipart/form-data">
      <input type="file" name="gem" size="50">
      <input type="submit" value="install">
    </form>
  </div>
</div>

<script type="text/javascript">
$(function(){
  $("#by_name_button").change(function(){
    $("#by_name").show();
    $("#by_file").hide();
  });
  $("#by_file_button").change(function(){
    $("#by_name").hide();
    $("#by_file").show();
  });
});
</script>
