<div id="new">
  <h2>アプリケーションの追加</h2>

  <form action="/add" method="POST" enctype="multipart/form-data">
    <input type="file" name="gem">
    <input type="submit" value="送信">
  </form>
</div>

<div id="list">
  <h2>アプリケーション一覧</h2>
  <?r if @applications.nil? or @applications.empty? ?>
      
  <?r else ?>
    <table>
      <tr>
        <th>名前</th>
        <th colspan="2">操作</th>
      </tr>
      <?r @applications.each do |name, app| ?>
      <?r next if app.nil? ?>
      <tr>
        <?r if app[:pid] ?>
          <td>
            <a href='http://localhost:#{h app[:port]}' target='_blank'>#{h app[:name]}</a>
          </td>
          <td>起動</td>
          <td><a href='/stop/#{u app[:id]}'>停止</a></td>
        <?r else ?>
          <td>#{h app[:name]}</td>
          <td><a href='/start/#{u app[:id]}' target='_blank' onclick='setTimeout(function(){window.location = window.location;}, 1000)'>
          起動</a></td>
          <td>停止</td>
        <?r end ?>
      </tr>
      <?r end ?>
    </table>
  <?r end ?>
</div>

<pre id="debug" style="display:none;">
<?r Application.each do |k, v| ?>
  #{h k.inspect} : #{v.inspect}
<?r end ?>
</pre>
